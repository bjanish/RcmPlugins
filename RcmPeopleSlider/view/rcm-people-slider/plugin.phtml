<?php

/**
 * RcmPeopleSlider content template
 *
 * Used for rendering simple content
 *
 * PHP version 5.3
 *
 * LICENSE: No License yet
 *
 * @category  Reliv
 * @package   Plugins\Image
 * @author    Rod McNew <rmcnew@relivinc.com>
 * @copyright 2012 Reliv International
 * @license   License.txt New BSD License
 * @version   GIT: <git_id>
 * @link      http://ci.reliv.com/confluence
 */
$this->headLink()->appendStylesheet(
    $this->basePath() . '/modules/rcm-people-slider/style.css'
);
$this->headScript()->appendFile(
    $this->basePath()
        . '/modules/rcm/vendor/aperture-slider/aperture-slider.js',
    'text/javascript'
);
$this->headScript()->appendFile(
    $this->basePath() . '/modules/rcm-people-slider/rcm-people-slider.js',
    'text/javascript'
);

//Figure out which person we are viewing. This non-js support is only for SEO.
$selectedPersonId = 0;
if (!empty($_GET['id']) && $_GET['id'] < count($this->ic['people'])) {
    $selectedPersonId = $_GET['id'];
}

$selectedPerson = $this->ic['people'][$selectedPersonId];

$uriParts=explode('?', $_SERVER['REQUEST_URI']);
$currentUrl = 'http://' . $_SERVER['HTTP_HOST'] . $uriParts[0];
?>
<script type="text/javascript">
    $(function () {
        new RcmPeopleSlider(
        <?php echo $this->instanceId?>,
        <?php echo json_encode($this->ic)?>
        );
    });
</script>
<div>

    <div class="mainPerson">
        <table>
            <tr>
                <td class="longDesc">
                    <?php echo $selectedPerson['longDesc']?>
                </td>
                <td>
                    <img class="largeImage"
                         src="<?php echo $selectedPerson['largeImage']?>">
                </td>
            </tr>
        </table>
    </div>

    <br>

    <div class="peopleBorder">

        <div class="left arrow">&nbsp;</div>

        <div class="peopleAperture">
            <div class="people">
                <?php foreach ($this->ic['people'] as $personId => $person): ?>
                <?php
                $classAppend = null;
                if ($personId == $selectedPersonId) {
                    $classAppend = ' selected';
                }
                ?>
                <a href="<?php echo "$currentUrl?id=$personId" //for SEO ?>"
                   class="person<?php echo $classAppend ?>"
                   data-personId="<?php echo $personId?>">
                   <img class="smallImage"
                         src="<?php echo $person['smallImage']?>">

                    <div class="shortDesc"><?php echo $person['shortDesc']?></div>
                </a>
                <?php endforeach?>
            </div>
        </div>

        <div class="right arrow">&nbsp;</div>

    </div>

</div>

