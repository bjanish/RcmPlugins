<?php

namespace RcmInstanceConfigTest\Entity;

require_once __DIR__ . '/../../autoload.php';

use RcmInstanceConfig\ViewHelper\TranslateHtml;

class TranslateHtmlTest extends \PHPUnit_Framework_TestCase
{
    /**
     * @covers \RcmInstanceConfig\ViewHelper\RcmEdit
     */
    public function testInvoke()
    {
        $view = $this->getMockBuilder('\Zend\View\Renderer\RendererInterface')
        ->getMock();

        $purifier = $this->getMockBuilder('\HTMLPurifier')->getMock();
        $purifier->expects($this->once())
            ->method('purify')
            ->will($this->returnValue(self::CLEAN_CONTENT));

        $unit = new TranslateHtml($purifier);
        $unit->getTranslator()
        $unit->setView(
            $this->getMockView(array(self::IC_KEY => self::DIRTY_CONTENT))
        );
        $this->assertEquals(
            '<p data-textEdit="salutation" class="bigFunky"><h1>aloha!</h1></p>',
            $unit->__invoke(
                self::IC_KEY, '<b>defaultContent<b>', 'p',
                array('class' => 'bigFunky')
            )
        );
    }

    function getMockPurifier()
    {
        return $purifier;
    }

    function getMockView($instanceConfig)
    {

        $view->instanceConfig = $instanceConfig;
        return $view;
    }
} 